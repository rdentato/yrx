<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>




  
  
  
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">



  


  
  
  
  
  
  
  <title>yrx - a pattern matching package</title><link type="text/css" href="yrx.css" rel="stylesheet"></head>
<body>




<table style="text-align: left; width: 100%;" border="0" cellpadding="0" cellspacing="0">




  <tbody>




    <tr>




      <td style="width: 150px; height: 16px;" colspan="1" rowspan="2"><img style="width: 150px; height: 90px;" alt="yrx logo" src="logo.png"></td>




      <td id="mnu" style="width: 821px; height: 76px;" align="right" valign="bottom"><a href="index.html">home</a>
&nbsp;|&nbsp; <a href="docs.html">docs</a>
&nbsp;|&nbsp; <a href="http://sourceforge.net/project/showfiles.php?group_id=159782">files</a>&nbsp;&nbsp;</td>




    </tr>




    <tr>




      <td class="topln" style="text-align: right; width: 821px; height: 14px; vertical-align: middle;"><small>30
May 2007 -&nbsp; <a href="mailto:rdentato@users.sourceforge.net">Remo
&nbsp;Dentato</a>&nbsp;</small>&nbsp;</td>




    </tr>




    <tr>




      <td style="width: 821px; height: 28px;" colspan="2" rowspan="1">&nbsp;<br>




      
      
      
      <table style="text-align: left; width: 85%;" align="center" border="0" cellpadding="0" cellspacing="0">




        <tbody>




          <tr>




            <td id="text"><!-- ## BEGIN TEXT -->
            
            
            
            <h2>Converting a set of patterns to a DFA</h2>




            
            
            
            <p>&nbsp; &nbsp;Transforming a set of of patterns in a Non Deterministic Finite Automaton (NFA) and then in a&nbsp; Deterministic Finite Automaton (DFA) is the standard approach for the automatic creating lexical scanners (LEX, re2c, ...).</p><p>&nbsp; &nbsp; Any NFA with <span style="font-style: italic;">n</span> states can be transformed in an equivalent DFA (i.e. a DFA that recognize the same language)&nbsp; with (in the worst case) <span style="font-style: italic;">n</span><sup>2</sup><span style="font-style: italic;"> </span> states.</p><p>&nbsp;
&nbsp;The number of states has a direct impact on the complexity and
size of the lexical scanner and also on the time needed to create it.</p><p>&nbsp;
&nbsp;Even if the worst case is very rare (pathological cases have to
be built on purpose), it could be worthwile to understand how to </p><p>&nbsp; &nbsp;Even if the algorithm presented here is a
novel creation of mine, it uses techniques and concepts that are
described in the literature. The bibliografy section in the
documentation page provides links to books and articles that are&nbsp;most relevant.&nbsp;</p>
&nbsp; &nbsp;Having to deal with patterns that restricted
            <p>&nbsp; &nbsp;The YRX algorithm to create a DFA&nbsp;is split in three steps:</p>




            
            
            
            <ol>


              <li>Create a NFA&nbsp;</li>


              <li>Eliminate empty transitions from the NFA</li>


              <li>Create the DFA&nbsp;</li>


            
            
            </ol>


            
            
            <h2>1. Create NFA</h2>
&nbsp;&nbsp; The creation of the NFA proceeds as depicted in the following figure:<br>
            <div style="text-align: center;"><img style="width: 567px; height: 226px;" alt="" src="nfa1.png"><br>
            </div>
            <br>
&nbsp; &nbsp;For each term of the expression the corresponding set of
arcs is appended to the automaton. &nbsp;The figure below shows an
example for the expression "a[bc]*a?b?"<br>
            <br>
            <div style="text-align: center;"><img style="width: 352px; height: 94px;" alt="" src="nfa2.png"><br>
            </div>
            <br>
&nbsp; &nbsp;By construction, the resulting NFA has some property that we'll use later for transforming it in a DFA:<br>
            <ol>
              <ol>
                <li>Each arc connect a state <span style="font-style: italic;">n</span> to itself or to the state <span style="font-style: italic;">n</span>+1 (i.e. there's no loop involving more than one node)</li>
                <li>If an empty transition to state <span style="font-style: italic;">n</span> exists, it comes from state <span style="font-style: italic;">n</span>-1 (i.e. &nbsp;no empty transition on the same node) </li>
              </ol>
            </ol>
&nbsp; &nbsp;Given a list of expressions, the resulting automata are
merged by their first state as shown below for the expressions "abc"
and "a[bd]c". Each final state is labeled with the&nbsp;position of
that expression in the list to allow the recognition of which epression
was matched in that final state.<br>
            <br>
            <br>
            <div style="text-align: center;"><img style="width: 259px; height: 143px;" alt="" src="nfa3.png"><br>
            </div>
 

            
            
            <h2>2. Eliminate empty transitions</h2>
&nbsp; &nbsp;To get rid of&nbsp;empty transitions (transitions that can
be executed without consuming any input) we can proceeds from the final
state backwards (thanks to properties 1 and 2 described in the
previous&nbsp; section) and replace them with copies of the arcs
to&nbsp; the next state.<br>
            <br>
&nbsp; &nbsp;The figure below shows the basic concept of copying arcs from a state to another:<br>
            <br>
            <br>
            <div style="text-align: center;"><img style="width: 512px; height: 83px;" alt="" src="nfa4.png"><br>
            </div>
            <br>
&nbsp; &nbsp;the two steps transition from 1 to 3 (follow the empty
transition from 1 to 2 and then the b transition from 2 to 3) is
replaced by a single transition from 1 to 3 labeled with the character
b.<br>
            <br>
&nbsp; &nbsp;The following figures show how the NFA for "a[bc]*a?b?" is transformed by this step.<br>
            <br>
            <div style="text-align: center;"><img style="width: 352px; height: 94px;" alt="" src="nfa2.png"><br>
            <img style="width: 352px; height: 118px;" alt="" src="nfa5.png"><br>
            </div>
            <br>
&nbsp; &nbsp;Note that the property of being a final state is propagated back when eliminating the empty transitions.<br>


            
            
            <h2>3. Create the DFA</h2>
&nbsp; &nbsp;The only source of non-determinism that is left is the
presence of more than one arc with the same label from a state to
different states. To eliminate them we'll merge the destination states
as shown in the next picture:<br>
            <br>
            <div style="text-align: center;"><img style="width: 456px; height: 113px;" alt="" src="nfa6.png"><br>
            </div>
            <br>
&nbsp; &nbsp;the arcs from 1 to 2 and from 1 to 4, both labeled with
"a", are replaced by a single arc from 1 to a newly created state 2,4
which has copies of the arcs from state 2 and state 4.<br>
            <br>
&nbsp; &nbsp;Note that we need to keep track of the merged states to avoid mergin the same states over and over again.<br>
            <h2>Example</h2>
&nbsp; &nbsp;Here is how the process works on the expression&nbsp; "a[bc]*a?b?". <br>
            <br>
&nbsp; &nbsp;The initial NFA is:<br>
            <div style="text-align: center;"><img style="width: 352px; height: 94px;" alt="" src="nfa2.png"><br>
            </div>
&nbsp; &nbsp;After removing empty transitions we have the following NFA:<br>
            <div style="text-align: center;"><img style="width: 352px; height: 118px;" alt="" src="nfa5.png"><br>
            </div>
&nbsp; &nbsp;State 1 has no non-determinsm. State 2 has two arcs
labeled "b" one to state 3 the other to state 5. Let's merge the two
and we'll get the following:<br>
            <div style="text-align: center;"><img style="width: 351px; height: 172px;" alt="" src="nfa7.png"><br>
            </div>
&nbsp; &nbsp;Now we'll process the successors of state 2. The state 3
has&nbsp;two arcs labeled with "b" one to 3 the other to 5 but we
already merged those two states so the arcs are replaced with an arc to
the merged state 3,5<br>
            <br>
            <div style="text-align: center;"><img style="width: 351px; height: 172px;" alt="" src="nfa8.png"><br>
            </div>
&nbsp; &nbsp;The other successor of 2 is 3,5 that has, again, two arcs
labeled with "b" leading to 3 and 5. We'll replace them with a loop
from&nbsp;3,5 to itself.<br>
            <br>
            <div style="text-align: center;"><img style="width: 351px; height: 187px;" alt="" src="nfa9.png"><br>
            </div>
            <br>
&nbsp; &nbsp; No other non-determinism is left and the result is the DFA we were looking for<br>
            <br>
            <h2>Captures</h2>
&nbsp; &nbsp;The main feature of YRX is the ability of capturing sub
match. &nbsp;YRX uses the concept of tagged arcs as suggested by
Laurakiri in his thesis "xxx".<br>
            <br>
&nbsp; &nbsp;Captures are included in the initial NFA as tagged empty
transition and then propagated during the determinization steps
described above<br>
            <br>
            <h2>Captures</h2><h2>
            </h2>
            <br>


<!-- ## END TEXT --> </td>




          </tr>




        <tr>


            <td id="text"></td>


          </tr>


        
        
        </tbody>
      
      
      
      </table>




&nbsp;<br>




      </td>




    </tr>




    <tr>




      <td colspan="2" rowspan="1" align="center"><strong></strong><a href="http://www.opensource.org"><img style="border: 0px solid ; width: 82px; height: 68px;" alt="" src="osi2.jpg"></a> &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.lua.org"><img style="border: 0px solid ; width: 64px; height: 64px;" alt="Lua Powered" title="Lua Powered" src="lua.gif"></a>&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;<a href="http://sourceforge.net"><img style="border: 0px solid ; width: 88px; height: 31px;" src="http://sflogo.sourceforge.net/sflogo.php?group_id=159782&amp;type=1" alt="SourceForge.net Logo" align="middle"></a>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;&nbsp;<a href="http://www.nvu.com" hreflang="en"><img style="border: 0px solid ; width: 135px; height: 52px;" src="made-with-Nvu-t.png" alt="Document made with Nvu"></a>
      </td>




    </tr>




  
  
  
  </tbody>
</table>




</body></html>